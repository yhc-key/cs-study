# Transport Layer(ì „ì†¡ê³„ì¸µ)

Tags: Network

# Pipelined Protocols

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled.png)

## Go-Back-N

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%201.png)

- Window size
    - í•œë²ˆì— ì–¼ë§ˆë§Œí¼ì˜ packetsì„ ë³´ë‚¼ ê²ƒì¸ì§€
    - windowì•ˆì— ìˆëŠ” ì• ë“¤ì€ bufferì•ˆì— ì €ì¥í•´ì•¼í•¨
- ì—¬ê¸°ì„œì˜ ACK ì„±ê²©
    - cumulative ACK : ìŒ“ì•„ë†“ëŠ”ë‹¤ëŠ” ì†Œë¦¬.
        - ACK 11ì´ë©´ í•œë²ˆì— 11ê¹Œì§€ ë°›ì•˜ë‹¤ëŠ” ê²ƒ.
        - ê°€ì¥ ë¨¼ì € ë³´ë‚´ëŠ” íŒ¨í‚· send baseì— timerê°€ ìˆìŒ
            - e.g. window sizeê°€ 4ë©´ 0,1,2,3ì´ ë³´ë‚´ì§ˆ ë•Œ 0í•œí…Œ timerê°€ ìˆë‹¤ëŠ” ëœ»
                
                ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%202.png)
                
- Receiver
    - ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ sequence numberë¥¼ ì²˜ë¦¬í•¨.
        - senderí•œí…Œ 0ì„ ë°›ì•˜ìœ¼ë©´ ê·¸ ë‹¤ìŒì€ ë¬´ì¡°ê±´ 1ë°›ì„ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼. ë§Œì•½ì— 2ê°€ ë” ë¨¼ì €ì˜¤ë©´ ê·¸ê±°ëŠ” ë²„ë¦¬ê³  1ì´ ì˜¬ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.
        
        ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%203.png)
        
- ë§Œì•½ window sizeê°€ 4ê³  ì¤‘ê°„ì— 6ì´ ìœ ì‹¤ë¨
    - 6ì´ send baseì¼ ë•Œ 6ì—ì„œ í„°ì§€ë‹ˆê¹Œ ë‹¤ì‹œ 4ê°œê°€ ëŒê³ ì„œ 6ìœ¼ë¡œ Go-Backí•˜ëŠ” ê±°ì„

## selective repeat

- ë¬¸ì œê°€ ìˆì„ ë•Œ ì¬ì „ì†¡ í•´ì£¼ì§€ë§Œ ì„ íƒëœ íŒ¨í‚·ë§Œ ì¬ì „ì†¡
    - ì˜ ì „ì†¡ëœ íŒ¨í‚·ì€ bufferì— ì €ì¥í•´ì£¼ê³  íƒ€ì´ë¨¸ í•´ì œë¨
    - 2ê°€ í„°ì§€ê³  3ì€ ì „ì†¡ì´ ì˜ëìœ¼ë©´ ì „ì†¡ì„ ACK3ì´ëŸ° ì‹ìœ¼ë¡œ ì „ì†¡í•´ì¤Œ
    - ê·¸ë¦¬ê³  2ëŠ” ì¬ì „ì†¡
    - 2ê°€ ì˜ ë°›ì•„ì ¸ì„œ 2,3,4,5ê°€ ë‹¤ ë°›ì•„ì§€ë©´ íŒ¨í‚·ì„ application layerë¡œ ì „ì†¡
    - ê·¸ë¦¬ê³  ê·¸ ë‹¤ìŒ windowë¡œ ë„˜ì–´ê°
    
    ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%204.png)
    

<aside>
ğŸ’¡ **ë”œë ˆë§ˆ**

</aside>

- window sizeê°€ 3ì´ë©´ sequence numberê°€ 0,1,2,3ì„ ì“´ë‹¤ê³  ê°€ì •(window size : N, sequence number : N+1)
- ê·¼ë° ë§Œì•½ì— ì²«ë²ˆì§¸ íŒ¨í‚·ì˜ ëª¨ë“  ì• ë“¤ì´ ì—ëŸ¬ê°€ ë‚¨(0,1,2) â†’ 3 ëŒ€ê¸°ì¤‘
- ê·¸ëŸ¬ë©´ ì¬ì „ì†¡ì„ 0ë¶€í„° ë‹¤ì‹œí•¨ â†’ sequence #ëŠ” 0
- ë¦¬ì‹œë²„ëŠ” 3ì´ ëŒ€ê¸°í•˜ê³  ìˆìœ¼ë‹ˆê¹Œ 3ë‹¤ìŒ ë²ˆí˜¸ë¡œ 0ì„ ë„£ì–´ì¤Œ
    - ì¤‘ë³µíŒ¨í‚·ì´ ì•„ë‹Œ ìƒˆë¡œìš´ íŒ¨í‚·ìœ¼ë¡œ ì¸ì‹í•´ë²„ë¦°ë‹¤.

â‡’ í•´ê²°ì±… : sequence number ë²”ìœ„ë¥¼ ëŠ˜ë¦¬ë©´ í•´ê²°ë¨

- ì–¼ë§Œí¼ìœ¼ë¡œ?

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%205.png)

---

# ì •ë¦¬

- point-to-point
    - í•œìŒì˜ ì†Œì¼“ì˜ í†µì‹ ì„ ì±…ì„ì§
- reliable, in-order byte stream
    - í•˜ë‚˜ë„ ìœ ì‹¤ë˜ì§€ ì•Šê³  ìˆœì„œëŒ€ë¡œ ê°„ë‹¤
- pipelined
    - í•œêº¼ë²ˆì— ìŸì•„ë¶“ëŠ”ë‹¤.
- send & received buffers
    - ëˆ„ê°€ senderê³  receiverê³  ë‚˜ëˆ ì ¸ìˆì§€ ì•ŠìŒ
- full duplex data
    - ë°ì´í„°ê°€ ì–‘ë°©í–¥ìœ¼ë¡œ ì§„í–‰í•œë‹¤ëŠ” ì–˜ê¸°
- connection-oriented
- flow controlled
    - receiverì˜ ìš©ëŸ‰ë§Œí¼ ë¶€ì–´ì£¼ëŠ”ê±°
- condition controller

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%206.png)

# TCP segment structure

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%207.png)

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%208.png)

- ê° í¬íŠ¸ê°€ 16bit(í¬íŠ¸ ë²ˆí˜¸ ë²”ìœ„ 0~2^16-1)

![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%209.png)

<aside>
ğŸ’¡ Aê°€ Bí•œí…Œ â€˜Câ€™ë¥¼ ë³´ë‚´ë ¤ê³  í•˜ëŠ” ìƒí™©

</aside>

- **ì‹œí€€ìŠ¤ ë²ˆí˜¸**
    - ë°”ì´íŠ¸ ìˆœì„œ ë²ˆí˜¸
- **ACKs**
    - cumulative ACK
    - ACK10â†’ 9ë²ˆê¹Œì§€ ë°›ì•˜ìœ¼ë‹ˆê¹Œ ì´ì œ 10 ì£¼ë¼ëŠ” ëœ»(Go-Backí•˜ê³  ì˜ë¯¸ ë‹¤ë¦„)
    - Bê°€ ë³´ë‚´ëŠ”ê²Œ ì—ì½”ì¸ì§€ ì•„ë‹Œì§€ êµ¬ë³„ ë¶ˆê°€

## Timeout

- ì‹œê°„ì œí•œì„ ì–´ë–»ê²Œ ì •í• ê¹Œ?
    - RTT (Round Trip Time) : segmentë¥¼ ë³´ë‚´ê³  ëŒì•„ì˜¤ëŠ” ì‹œê°„
        - ì‹œê°„ ì œí•œì„ RTTë¡œ ì •í•´ë³´ì
            - ê²½ë¡œë§ˆë‹¤ RTTê°’ì´ ë‹¤ë¦„(ê±°ë¦¬ë§ˆë‹¤ ë‹¤ë¥´ê³ , Queue delayê°€ ë‹¤ë¦„)â†’RTTë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¡ê¸°ê°€ ì¤‘êµ¬ë‚œë°©ì´ë¼ í˜ë“¤ë‹¤.
    - Estimated RTT : ë³´ì •ëœ RTTê°’
        - ë„ˆë¬´ íƒ€ì´íŠ¸í•  ë•Œë„ ìˆìŒ
            
            ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%2010.png)
            
    - Dev RTT : Estimated RTTì— ì‹œê°„ì„ ë”í•´ì¤Œ
    
    ## TCP Reliable data transfer
    
    - timer 1ê°œ ì‚¬ìš©
        - íƒ€ì´ë¨¸ê°€ í„°ì§€ë©´ ë”± ê·¸ê±° í•˜ë‚˜ë§Œ ì¬ì „ì†¡
    
    ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%2011.png)
    
    1. ìƒí™©
        
        segment 1 : 92~99
        
        segment 2 : 100~119
        
        - BëŠ” ë‘˜ ë‹¤ ì˜ ë°›ì•„ì„œ ACK 120ê¸°ë‹¤ë¦¼
        - senderê°€ responseê¸°ë‹¤ë¦¬ë˜ ì¤‘ì— 1ë²ˆ ì„¸ê·¸ë¨¼íŠ¸ê°€ timerê°€ í„°ì§
        - 1ë²ˆ ì¬ì „ì†¡í•´ì„œ 120ë²ˆ ê¸°ë‹¤ë¦¬ëŠ” ë¦¬ì‹œë²„ì—ê²Œ ë‚ ë¼ê°€ë©´ ë²„ë ¤ì§
        - ê·¸ë¦¬ê³  ACK120ë²ˆì´ Bì—ì„œ Aë¡œ ë‚ ë¼ê°
        - ê·¸ëŸ¬ë©´ 119ê¹Œì§€ëŠ” ì˜ ì²˜ë¦¬ëœê±°ë‹ˆê¹Œ A ë¹„ì›€
        
    
    ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%2012.png)
    
    1. ìƒí™©
        - 2ì™€ ê±°ì˜ ë™ì¼í•œë° 1ë²ˆ ì„¸ê·¸ë¨¼íŠ¸ê°€ ìœ ì‹¤ëœ ìƒí™©
        - 2ì™€ ë¹„ìŠ·í•˜ê²Œ ë™ì‘
    
    ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%2013.png)
    
    ![Untitled](Transport%20Layer(%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC)%202f4789b102664cbda0ad696c6395d8ed/Untitled%2014.png)
    

## TCP ê¶Œê³ ì‚¬í•­

- delayë¥¼ í•´ë¼ â†’ í•œë²ˆì— ë‹¤ ë‹´ì•„ì„œ ë³´ë‚´ë¼ê³ 
- **fast retransmit :** timerê°€ í„°ì§€ê¸° ì „ì— ìœ ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŒ
    - íŠ¹ì •ë²ˆí˜¸ì˜ ACKê°€ ê³„ì† ë“¤ì–´ì˜¤ë©´ ìœ ì‹¤ì¸ê²ƒì„ â†’ ë™ì¼ ë²ˆí˜¸ê°€ 4ë²ˆì´ìƒ ë°˜ë³µë˜ë©´ ìœ ì‹¤ë¡œ íŒë‹¨í•´ì¤Œâ‡’ **3 duplicate ACK**
    - ì—†ì–´ë„ ë˜ëŠ” ê¸°ëŠ¥. í•„ìˆ˜ëŠ” ì•„ë‹˜